<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>War of Dots - Extreme</title>
    <style>
        body { margin: 0; overflow: hidden; background: #0a0a0a; font-family: 'Segoe UI', sans-serif; }
        canvas { display: block; }
        #ui { position: absolute; top: 15px; left: 15px; color: white; font-size: 20px; font-weight: bold; pointer-events: none; z-index: 10; text-shadow: 2px 2px 5px rgba(0,0,0,0.7); }
        #lang-menu {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); display: flex; flex-direction: column;
            align-items: center; justify-content: center; z-index: 100;
        }
        .lang-btn {
            width: 240px; padding: 18px; margin: 12px; border: none; border-radius: 40px;
            font-size: 18px; cursor: pointer; background: #2ecc71; color: white; transition: 0.3s;
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.3);
        }
        .lang-btn:hover { transform: translateY(-3px) scale(1.05); background: #27ae60; }
        h1 { color: white; font-size: 40px; margin-bottom: 30px; letter-spacing: 2px; }
    </style>
</head>
<body>

    <div id="lang-menu">
        <h1>WAR OF DOTS</h1>
        <button class="lang-btn" onclick="startGame('uk')">üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</button>
        <button class="lang-btn" onclick="startGame('ru')">üá∑üá∫ –†—É—Å—Å–∫–∏–π</button>
        <button class="lang-btn" onclick="startGame('be')">üáßüáæ –ë–µ–ª–∞—Ä—É—Å–∫–∞—è</button>
        <button class="lang-btn" onclick="startGame('en')">üá¨üáß English</button>
    </div>

    <div id="ui">
        <div><span id="mass-label">Mass</span>: <span id="score">10</span></div>
        <div style="color: #f1c40f;"><span id="best-label">Best</span>: <span id="highscore">0</span></div>
    </div>
    
    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreEl = document.getElementById('score');
        const highscoreEl = document.getElementById('highscore');
        const massLabel = document.getElementById('mass-label');
        const bestLabel = document.getElementById('best-label');
        const langMenu = document.getElementById('lang-menu');

        const translations = {
            uk: { mass: "–ú–∞—Å–∞", best: "–†–µ–∫–æ—Ä–¥", over: "–í–∞—Å –ø—Ä–æ–∫–æ–≤—Ç–Ω—É–ª–∏!" },
            ru: { mass: "–ú–∞—Å—Å–∞", best: "–†–µ–∫–æ—Ä–¥", over: "–í–∞—Å –ø—Ä–æ–≥–ª–æ—Ç–∏–ª–∏!" },
            be: { mass: "–ú–∞—Å–∞", best: "–†—ç–∫–æ—Ä–¥", over: "–í–∞—Å –ø—Ä–∞–≥–ª—ã–Ω—É–ª—ñ!" },
            en: { mass: "Mass", best: "Best", over: "You were swallowed!" }
        };

        let currentLang = 'en';
        let gameRunning = false;
        const MAP_SIZE = 5000; // –í–µ–ª–∏—á–µ–∑–Ω–∞ –∫–∞—Ä—Ç–∞

        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let savedBest = localStorage.getItem('dots_highscore_v2') || 0;
        highscoreEl.innerText = savedBest;

        let player = { x: MAP_SIZE/2, y: MAP_SIZE/2, radius: 18, score: 10, color: '#00a8ff' };
        let food = [];
        let enemies = [];
        let camera = { x: 0, y: 0, zoom: 1 };

        function startGame(lang) {
            currentLang = lang;
            massLabel.innerText = translations[lang].mass;
            bestLabel.innerText = translations[lang].best;
            langMenu.style.display = 'none';
            gameRunning = true;
            for(let i=0; i<300; i++) spawnFood();
            for(let i=0; i<60; i++) spawnEnemy();
            update();
        }

        function spawnFood() {
            food.push({
                x: Math.random() * MAP_SIZE,
                y: Math.random() * MAP_SIZE,
                radius: 4.5,
                color: `hsl(${Math.random() * 360}, 80%, 50%)`
            });
        }

        function spawnEnemy() {
            let isHunter = Math.random() > 0.7; // 30% –≤–æ—Ä–æ–≥—ñ–≤ - —Å–∏–ª—å–Ω—ñ—à—ñ –∑–∞ —Ç–µ–±–µ
            let size;
            if (isHunter) {
                size = player.radius * (1.2 + Math.random() * 0.8); // –ù–∞ 20-80% –±—ñ–ª—å—à—ñ –∑–∞ –≥—Ä–∞–≤—Ü—è
            } else {
                size = 10 + Math.random() * (player.radius * 1.5);
            }

            enemies.push({
                x: Math.random() * MAP_SIZE,
                y: Math.random() * MAP_SIZE,
                radius: size,
                dx: (Math.random() - 0.5) * 5,
                dy: (Math.random() - 0.5) * 5,
                color: isHunter ? '#ff4757' : '#ffa502', // –ß–µ—Ä–≤–æ–Ω—ñ - –Ω–µ–±–µ–∑–ø–µ—á–Ω—ñ, –ü–æ–º–∞—Ä–∞–Ω—á–µ–≤—ñ - —Ä—ñ–∑–Ω—ñ
                type: isHunter ? 'hunter' : 'normal'
            });
        }

        let mouse = { x: canvas.width/2, y: canvas.height/2 };
        window.addEventListener('mousemove', e => { mouse.x = e.clientX; mouse.y = e.clientY; });
        window.addEventListener('touchmove', e => { 
            mouse.x = e.touches[0].clientX; 
            mouse.y = e.touches[0].clientY; 
        }, {passive: false});

        function gameOver() {
            gameRunning = false;
            if (player.score > savedBest) {
                localStorage.setItem('dots_highscore_v2', player.score);
            }
            alert(translations[currentLang].over);
            location.reload();
        }

        function update() {
            if (!gameRunning) return;

            let angle = Math.atan2(mouse.y - canvas.height/2, mouse.x - canvas.width/2);
            let speed = Math.max(2, 5 - player.radius/100); // –ß–∏–º –±—ñ–ª—å—à–∏–π, —Ç–∏–º –ø–æ–≤—ñ–ª—å–Ω—ñ—à–∏–π
            player.x += Math.cos(angle) * speed;
            player.y += Math.sin(angle) * speed;

            player.x = Math.max(0, Math.min(MAP_SIZE, player.x));
            player.y = Math.max(0, Math.min(MAP_SIZE, player.y));

            camera.x = player.x - canvas.width / 2 / camera.zoom;
            camera.y = player.y - canvas.height / 2 / camera.zoom;
            camera.zoom = 1 / (1 + (player.radius - 18) / 300); 

            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.save();
            ctx.scale(camera.zoom, camera.zoom);
            ctx.translate(-camera.x, -camera.y);

            // –°—Ç—ñ–Ω–∏
            ctx.strokeStyle = "#ff4757"; ctx.lineWidth = 20;
            ctx.strokeRect(-10, -10, MAP_SIZE+20, MAP_SIZE+20);

            // –°—ñ—Ç–∫–∞
            ctx.strokeStyle = "rgba(255,255,255,0.03)"; ctx.lineWidth = 2;
            for(let i=0; i<=MAP_SIZE; i+=150) { ctx.beginPath(); ctx.moveTo(i,0); ctx.lineTo(i,MAP_SIZE); ctx.stroke(); }
            for(let i=0; i<=MAP_SIZE; i+=150) { ctx.beginPath(); ctx.moveTo(0,i); ctx.lineTo(MAP_SIZE,i); ctx.stroke(); }

            food.forEach((f, i) => {
                ctx.beginPath(); ctx.arc(f.x, f.y, f.radius, 0, Math.PI*2);
                ctx.fillStyle = f.color; ctx.fill();
                if (Math.hypot(player.x - f.x, player.y - f.y) < player.radius) {
                    food.splice(i, 1); player.radius += 0.25; player.score++;
                    scoreEl.innerText = player.score; spawnFood();
                }
            });

            enemies.forEach((en, i) => {
                en.x += en.dx; en.y += en.dy;
                if (en.x < 0 || en.x > MAP_SIZE) en.dx *= -1;
                if (en.y < 0 || en.y > MAP_SIZE) en.dy *= -1;

                ctx.beginPath(); ctx.arc(en.x, en.y, en.radius, 0, Math.PI*2);
                ctx.fillStyle = en.color; ctx.fill();
                // –¢—ñ–Ω—å –¥–ª—è –º–∏—Å–ª–∏–≤—Ü—ñ–≤
                if(en.type === 'hunter') {
                    ctx.strokeStyle = "white"; ctx.lineWidth = 2; ctx.stroke();
                }

                let d = Math.hypot(player.x - en.x, player.y - en.y);
                if (d < player.radius + en.radius - 5) {
                    if (player.radius > en.radius * 1.15) {
                        player.radius += en.radius / 5; player.score += Math.floor(en.radius);
                        enemies.splice(i, 1); scoreEl.innerText = player.score; spawnEnemy();
                    } else if (en.radius > player.radius * 1.05) {
                        gameOver();
                    }
                }
            });

            // –ì—Ä–∞–≤–µ—Ü—å
            ctx.beginPath(); ctx.arc(player.x, player.y, player.radius, 0, Math.PI*2);
            ctx.fillStyle = player.color; ctx.fill();
            ctx.strokeStyle = "white"; ctx.lineWidth = 4; ctx.stroke();

            ctx.restore();
            requestAnimationFrame(update);
        }
    </script>
</body>
</html>